<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Homu queue - {{repo_name}}</title>
        <style>
            h1 { font-size: 20px; }
            h2 { font-size: 16px; }
            p { font-size: 15px; }

            table { border-collapse: collapse; }
            td, th { border: 2px solid white; padding: 5px; font-size: 13px; }
            tr:nth-child(even) { background: #ddd; }
            button { display: block; margin: 15px 0; }

            .success { background-color: purple; }
            .failure, .error { background-color: #f66; }
            .pending { background-color: yellow; }
            .approved { background-color: #0f0; }

            .yes { color: green; }
            .no { color: red; }
        </style>
    </head>
    <body>
        <h1>Homu queue - {{repo_name}}</h1>

        <button type="button" id="rollup">Create a rollup</button>

        <p>{{ total }} total, {{ approved }} approved, {{ rolled_up }} rolled up, {{ failed }} failed</p>

        <table>
            <tr>
                <th>Number</th>
                <th>Status</th>
                <th>Priority</th>
                <th>Head ref</th>
                <th>Title</th>
                <th>Approved by</th>
                <th>Mergeable</th>
                <th>Assignee</th>
            </tr>

            {% for state in states %}
            <tr>
                <td><a href="{{state.url}}">{{state.num}}</a></td>
                <td class="{{state.status}}">{{state.status}}</td>
                <td>{{state.priority}}</td>
                <td>{{state.head_ref}}</td>
                <td>{{state.title}}</td>
                <td>{{state.approved_by}}</td>
                <td class="{{state.mergeable}}">{{state.mergeable}}</td>
                <td>{{state.assignee}}</td>
            </tr>
            {% endfor %}
        </table>

        <script>
            document.getElementById('rollup').onclick = function(ev) {
                if (!confirm('This will create a new pull request. Proceed?')) return;

                location = 'https://github.com/login/oauth/authorize' +
                    '?client_id={{oauth_client_id}}' +
                    '&scope=public_repo' +
                    '&state=' + encodeURIComponent(JSON.stringify({
                        repo: '{{repo_name}}'
                    }));
            };
        </script>
    </body>
</html>
